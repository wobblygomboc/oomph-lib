\hypertarget{classoomph_1_1RefineableSolidElement}{}\doxysection{oomph\+::Refineable\+Solid\+Element Class Reference}
\label{classoomph_1_1RefineableSolidElement}\index{oomph::RefineableSolidElement@{oomph::RefineableSolidElement}}


/////////////////////////////////////////////////////////////////// ///////////////////////////////////////////////////////////////////  




{\ttfamily \#include $<$refineable\+\_\+elements.\+h$>$}

Inheritance diagram for oomph\+::Refineable\+Solid\+Element\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=0.865916cm]{classoomph_1_1RefineableSolidElement}
\end{center}
\end{figure}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classoomph_1_1RefineableSolidElement_a7e30a2a6c56a69a37ce327a2cfb69e40}{Refineable\+Solid\+Element}} ()
\begin{DoxyCompactList}\small\item\em Constructor. \end{DoxyCompactList}\item 
virtual \mbox{\hyperlink{classoomph_1_1RefineableSolidElement_a7bb075ed922e71ed102a02adfe2d24e7}{$\sim$\+Refineable\+Solid\+Element}} ()
\begin{DoxyCompactList}\small\item\em Virtual Destructor, delete any allocated storage. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classoomph_1_1RefineableSolidElement_a7718105cbc38cff969a246b093b6ecee}{assign\+\_\+solid\+\_\+local\+\_\+eqn\+\_\+numbers}} (const bool \&store\+\_\+local\+\_\+dof\+\_\+pt)
\begin{DoxyCompactList}\small\item\em Overload the local equation numbers for \mbox{\hyperlink{classoomph_1_1Data}{Data}} stored as part of solid nodes to include hanging node data. \end{DoxyCompactList}\item 
unsigned \mbox{\hyperlink{classoomph_1_1RefineableSolidElement_a690e24cdbd9308da1b9e705fd0340de8}{ngeom\+\_\+data}} () const
\begin{DoxyCompactList}\small\item\em The number of geometric data affecting a Refineable\+Solid\+Finite\+Element is the positional \mbox{\hyperlink{classoomph_1_1Data}{Data}} of all non-\/hanging nodes plus the geometric \mbox{\hyperlink{classoomph_1_1Data}{Data}} of all distinct master nodes. Recomputed on the fly. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classoomph_1_1Data}{Data}} $\ast$ \mbox{\hyperlink{classoomph_1_1RefineableSolidElement_a3f20de56e3a920644b01dac184f67ef1}{geom\+\_\+data\+\_\+pt}} (const unsigned \&j)
\begin{DoxyCompactList}\small\item\em Return pointer to the j-\/th \mbox{\hyperlink{classoomph_1_1Data}{Data}} item that the object\textquotesingle{}s shape depends on\+: Positional data of non-\/hanging nodes and positional data of master nodes. Recomputed on the fly. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classoomph_1_1RefineableSolidElement_ac895a84017b3eb57dadc19384b6ce7f4}{identify\+\_\+geometric\+\_\+data}} (std\+::set$<$ \mbox{\hyperlink{classoomph_1_1Data}{Data}} $\ast$ $>$ \&geometric\+\_\+data\+\_\+pt)
\begin{DoxyCompactList}\small\item\em Specify \mbox{\hyperlink{classoomph_1_1Data}{Data}} that affects the geometry of the element by adding the position \mbox{\hyperlink{classoomph_1_1Data}{Data}} to the set that\textquotesingle{}s passed in. (This functionality is required in FSI problems; set is used to avoid double counting). Refineable version includes hanging nodes. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classoomph_1_1RefineableSolidElement_a97f911c422af3e4fbd078b58cfe3e207}{fill\+\_\+in\+\_\+jacobian\+\_\+from\+\_\+solid\+\_\+position\+\_\+by\+\_\+fd}} (\mbox{\hyperlink{classoomph_1_1Vector}{Vector}}$<$ double $>$ \&residuals, \mbox{\hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}}$<$ double $>$ \&jacobian)
\begin{DoxyCompactList}\small\item\em Compute element residual \mbox{\hyperlink{classoomph_1_1Vector}{Vector}} and element Jacobian matrix corresponding to the solid positions. Overloaded version to take the hanging nodes into account. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{classoomph_1_1RefineableSolidElement_a23a8382cc9da7809752851db65e20241}{is\+\_\+undeformed\+\_\+macro\+\_\+element\+\_\+used\+\_\+for\+\_\+new\+\_\+lagrangian\+\_\+coords}} () const
\begin{DoxyCompactList}\small\item\em Return the flag deciding if the Lagrangian coordinates of newly-\/created interior Solid\+Nodes are to be determined by the father element\textquotesingle{}s undeformed \mbox{\hyperlink{classoomph_1_1MacroElement}{Macro\+Element}} representation (if it has one). Default\+: False as it means that, following a refinement an element is no longer in equilbrium (as the Lagrangian coordinate is determined differently from the Eulerian one). However, basing the Lagrangian coordinates on the undeformed \mbox{\hyperlink{classoomph_1_1MacroElement}{Macro\+Element}} can be more stable numerically and for steady problems it\textquotesingle{}s not a big deal either way as the difference between the two formulations only matters at finite resolution so we have no right to say that one is \char`\"{}more correct\char`\"{} than the other... \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classoomph_1_1RefineableSolidElement_a65b054a8a113f03e2a11647faa104b6f}{enable\+\_\+use\+\_\+of\+\_\+undeformed\+\_\+macro\+\_\+element\+\_\+for\+\_\+new\+\_\+lagrangian\+\_\+coords}} ()
\begin{DoxyCompactList}\small\item\em Set the flag deciding if the Lagrangian coordinates of newly-\/created interior Solid\+Nodes are to be determined by the father element\textquotesingle{}s undeformed \mbox{\hyperlink{classoomph_1_1MacroElement}{Macro\+Element}} representation (if it has one). \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classoomph_1_1RefineableSolidElement_a1d85edf9f84720ac0de66427d75a5871}{disable\+\_\+use\+\_\+of\+\_\+undeformed\+\_\+macro\+\_\+element\+\_\+for\+\_\+new\+\_\+lagrangian\+\_\+coords}} ()
\begin{DoxyCompactList}\small\item\em Unset the flag deciding if the Lagrangian coordinates of newly-\/created interior Solid\+Nodes are to be determined by the father element\textquotesingle{}s undeformed \mbox{\hyperlink{classoomph_1_1MacroElement}{Macro\+Element}} representation (if it has one). \end{DoxyCompactList}\item 
\mbox{\hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}}$<$ int $>$ \& \mbox{\hyperlink{classoomph_1_1RefineableSolidElement_a547e50bc2c13c6e4852c543cd7d38f74}{local\+\_\+position\+\_\+hang\+\_\+eqn}} (\mbox{\hyperlink{classoomph_1_1Node}{Node}} $\ast$const \&\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\+\_\+pt}})
\begin{DoxyCompactList}\small\item\em Access the local equation number of of hanging node variables associated with nodal positions. The function returns a dense matrix that contains all the local equation numbers corresponding to the positional degrees of freedom. \end{DoxyCompactList}\item 
virtual void \mbox{\hyperlink{classoomph_1_1RefineableSolidElement_a159967ccbb5327b2ee04154a11b1b51c}{further\+\_\+build}} ()
\begin{DoxyCompactList}\small\item\em Further build\+: Pass the father\textquotesingle{}s Use\+\_\+undeformed\+\_\+macro\+\_\+element\+\_\+for\+\_\+new\+\_\+lagrangian\+\_\+coords flag down, then call the underlying \mbox{\hyperlink{classoomph_1_1RefineableElement}{Refineable\+Element}}\textquotesingle{}s version. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Protected Member Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{classoomph_1_1RefineableSolidElement_ae0d5a2fc617a11036a80d0d016292d7a}{assemble\+\_\+local\+\_\+to\+\_\+lagrangian\+\_\+jacobian}} (const \mbox{\hyperlink{classoomph_1_1DShape}{DShape}} \&dpsids, \mbox{\hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}}$<$ double $>$ \&jacobian) const
\begin{DoxyCompactList}\small\item\em Assemble the jacobian matrix for the mapping from local to lagrangian coordinates, given the derivatives of the shape function Overload the standard version to use the hanging information for the lagrangian coordinates. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classoomph_1_1RefineableSolidElement_a5843ecc4836508342150862e11af99f4}{assemble\+\_\+local\+\_\+to\+\_\+lagrangian\+\_\+jacobian2}} (const \mbox{\hyperlink{classoomph_1_1DShape}{DShape}} \&d2psids, \mbox{\hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}}$<$ double $>$ \&jacobian2) const
\begin{DoxyCompactList}\small\item\em Assemble the the \char`\"{}jacobian\char`\"{} matrix of second derivatives, given the second derivatives of the shape functions w.\+r.\+t. local coordinates Overload the standard version to use the hanging information for the lagrangian coordinates. \end{DoxyCompactList}\item 
double \mbox{\hyperlink{classoomph_1_1RefineableSolidElement_a492846d9f2c5d5235f9f3ff1001d4ec8}{local\+\_\+to\+\_\+lagrangian\+\_\+mapping\+\_\+diagonal}} (const \mbox{\hyperlink{classoomph_1_1DShape}{DShape}} \&dpsids, \mbox{\hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}}$<$ double $>$ \&jacobian, \mbox{\hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}}$<$ double $>$ \&inverse\+\_\+jacobian) const
\begin{DoxyCompactList}\small\item\em Calculate the mapping from local to Lagrangian coordinates given the derivatives of the shape functions w.\+r.\+t the local coorindates. assuming that the coordinates are aligned in the direction of the local coordinates, i.\+e. there are no cross terms and the jacobian is diagonal. This function returns the determinant of the jacobian, the jacobian and the inverse jacobian. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Protected Attributes}
\begin{DoxyCompactItemize}
\item 
bool \mbox{\hyperlink{classoomph_1_1RefineableSolidElement_a7a398d47d3eaf9af809821d806b65973}{Use\+\_\+undeformed\+\_\+macro\+\_\+element\+\_\+for\+\_\+new\+\_\+lagrangian\+\_\+coords}}
\begin{DoxyCompactList}\small\item\em Flag deciding if the Lagrangian coordinates of newly-\/created interior Solid\+Nodes are to be determined by the father element\textquotesingle{}s undeformed \mbox{\hyperlink{classoomph_1_1MacroElement}{Macro\+Element}} representation (if it has one). Default\+: False as it means that, following a refinement an element is no longer in equilbrium (as the Lagrangian coordinate is determined differently from the Eulerian one). However, basing the Lagrangian coordinates on the undeformed \mbox{\hyperlink{classoomph_1_1MacroElement}{Macro\+Element}} can be more stable numerically and for steady problems it\textquotesingle{}s not a big deal either way as the difference between the two formulations only matters at finite resolution so we have no right to say that one is \char`\"{}more correct\char`\"{} than the other... \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Private Member Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{classoomph_1_1RefineableSolidElement_a973020f4458c30aa458468b7f757ba7c}{assign\+\_\+solid\+\_\+hanging\+\_\+local\+\_\+eqn\+\_\+numbers}} (const bool \&store\+\_\+local\+\_\+dof\+\_\+pt)
\begin{DoxyCompactList}\small\item\em Assign local equation numbers to the hanging values associated with positions or additional solid values. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Private Attributes}
\begin{DoxyCompactItemize}
\item 
std\+::map$<$ \mbox{\hyperlink{classoomph_1_1Node}{Node}} $\ast$, \mbox{\hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}}$<$ int $>$ $>$ \mbox{\hyperlink{classoomph_1_1RefineableSolidElement_aa361b9441808d7d194494125abd1f6fd}{Local\+\_\+position\+\_\+hang\+\_\+eqn}}
\begin{DoxyCompactList}\small\item\em Storage for local equation numbers of hanging node variables associated with nodal positions. local position equation number = Local\+\_\+position\+\_\+hang\+\_\+eqn(master\+\_\+node\+\_\+pt,ival) \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Additional Inherited Members}


\doxysubsection{Detailed Description}
/////////////////////////////////////////////////////////////////// /////////////////////////////////////////////////////////////////// 

Refineable\+Solid\+Elements are Solid\+Finite\+Elements that may be subdivided into children to provide a better local approximation to the solution. The distinction is required to keep a clean separation between problems that alter nodal positions and others. A number of procedures are generic and are included in this class. 

Definition at line \mbox{\hyperlink{refineable__elements_8h_source_l00872}{872}} of file \mbox{\hyperlink{refineable__elements_8h_source}{refineable\+\_\+elements.\+h}}.



\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classoomph_1_1RefineableSolidElement_a7e30a2a6c56a69a37ce327a2cfb69e40}\label{classoomph_1_1RefineableSolidElement_a7e30a2a6c56a69a37ce327a2cfb69e40}} 
\index{oomph::RefineableSolidElement@{oomph::RefineableSolidElement}!RefineableSolidElement@{RefineableSolidElement}}
\index{RefineableSolidElement@{RefineableSolidElement}!oomph::RefineableSolidElement@{oomph::RefineableSolidElement}}
\doxysubsubsection{\texorpdfstring{RefineableSolidElement()}{RefineableSolidElement()}}
{\footnotesize\ttfamily oomph\+::\+Refineable\+Solid\+Element\+::\+Refineable\+Solid\+Element (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Constructor. 



Definition at line \mbox{\hyperlink{refineable__elements_8h_source_l00928}{928}} of file \mbox{\hyperlink{refineable__elements_8h_source}{refineable\+\_\+elements.\+h}}.

\mbox{\Hypertarget{classoomph_1_1RefineableSolidElement_a7bb075ed922e71ed102a02adfe2d24e7}\label{classoomph_1_1RefineableSolidElement_a7bb075ed922e71ed102a02adfe2d24e7}} 
\index{oomph::RefineableSolidElement@{oomph::RefineableSolidElement}!````~RefineableSolidElement@{$\sim$RefineableSolidElement}}
\index{````~RefineableSolidElement@{$\sim$RefineableSolidElement}!oomph::RefineableSolidElement@{oomph::RefineableSolidElement}}
\doxysubsubsection{\texorpdfstring{$\sim$RefineableSolidElement()}{~RefineableSolidElement()}}
{\footnotesize\ttfamily virtual oomph\+::\+Refineable\+Solid\+Element\+::$\sim$\+Refineable\+Solid\+Element (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [virtual]}}



Virtual Destructor, delete any allocated storage. 



Definition at line \mbox{\hyperlink{refineable__elements_8h_source_l00936}{936}} of file \mbox{\hyperlink{refineable__elements_8h_source}{refineable\+\_\+elements.\+h}}.



\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{classoomph_1_1RefineableSolidElement_ae0d5a2fc617a11036a80d0d016292d7a}\label{classoomph_1_1RefineableSolidElement_ae0d5a2fc617a11036a80d0d016292d7a}} 
\index{oomph::RefineableSolidElement@{oomph::RefineableSolidElement}!assemble\_local\_to\_lagrangian\_jacobian@{assemble\_local\_to\_lagrangian\_jacobian}}
\index{assemble\_local\_to\_lagrangian\_jacobian@{assemble\_local\_to\_lagrangian\_jacobian}!oomph::RefineableSolidElement@{oomph::RefineableSolidElement}}
\doxysubsubsection{\texorpdfstring{assemble\_local\_to\_lagrangian\_jacobian()}{assemble\_local\_to\_lagrangian\_jacobian()}}
{\footnotesize\ttfamily void oomph\+::\+Refineable\+Solid\+Element\+::assemble\+\_\+local\+\_\+to\+\_\+lagrangian\+\_\+jacobian (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{classoomph_1_1DShape}{DShape}} \&}]{dpsids,  }\item[{\mbox{\hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}}$<$ double $>$ \&}]{jacobian }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}}



Assemble the jacobian matrix for the mapping from local to lagrangian coordinates, given the derivatives of the shape function Overload the standard version to use the hanging information for the lagrangian coordinates. 

Internal function that is used to assemble the jacobian of the mapping from local coordinates (s) to the lagrangian coordinates (xi), given the derivatives of the shape functions. 

Reimplemented from \mbox{\hyperlink{classoomph_1_1SolidFiniteElement_a91f14d25d145e7ef47d55cabfd332f5c}{oomph\+::\+Solid\+Finite\+Element}}.



Definition at line \mbox{\hyperlink{refineable__elements_8cc_source_l00855}{855}} of file \mbox{\hyperlink{refineable__elements_8cc_source}{refineable\+\_\+elements.\+cc}}.



References \mbox{\hyperlink{elements_8h_source_l02611}{oomph\+::\+Finite\+Element\+::dim()}}, \mbox{\hyperlink{cfortran_8h_source_l00603}{i}}, \mbox{\hyperlink{elements_8h_source_l03912}{oomph\+::\+Solid\+Finite\+Element\+::lagrangian\+\_\+position\+\_\+gen()}}, \mbox{\hyperlink{elements_8h_source_l03785}{oomph\+::\+Solid\+Finite\+Element\+::nnodal\+\_\+lagrangian\+\_\+type()}}, and \mbox{\hyperlink{elements_8h_source_l02210}{oomph\+::\+Finite\+Element\+::nnode()}}.

\mbox{\Hypertarget{classoomph_1_1RefineableSolidElement_a5843ecc4836508342150862e11af99f4}\label{classoomph_1_1RefineableSolidElement_a5843ecc4836508342150862e11af99f4}} 
\index{oomph::RefineableSolidElement@{oomph::RefineableSolidElement}!assemble\_local\_to\_lagrangian\_jacobian2@{assemble\_local\_to\_lagrangian\_jacobian2}}
\index{assemble\_local\_to\_lagrangian\_jacobian2@{assemble\_local\_to\_lagrangian\_jacobian2}!oomph::RefineableSolidElement@{oomph::RefineableSolidElement}}
\doxysubsubsection{\texorpdfstring{assemble\_local\_to\_lagrangian\_jacobian2()}{assemble\_local\_to\_lagrangian\_jacobian2()}}
{\footnotesize\ttfamily void oomph\+::\+Refineable\+Solid\+Element\+::assemble\+\_\+local\+\_\+to\+\_\+lagrangian\+\_\+jacobian2 (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{classoomph_1_1DShape}{DShape}} \&}]{d2psids,  }\item[{\mbox{\hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}}$<$ double $>$ \&}]{jacobian2 }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}}



Assemble the the \char`\"{}jacobian\char`\"{} matrix of second derivatives, given the second derivatives of the shape functions w.\+r.\+t. local coordinates Overload the standard version to use the hanging information for the lagrangian coordinates. 

Internal function that is used to assemble the jacobian of second derivatives of the the mapping from local coordinates (s) to the lagrangian coordinates (xi), given the second derivatives of the shape functions. 

Reimplemented from \mbox{\hyperlink{classoomph_1_1SolidFiniteElement_a33ab1427cebdc36ff77d897f5db9f3a6}{oomph\+::\+Solid\+Finite\+Element}}.



Definition at line \mbox{\hyperlink{refineable__elements_8cc_source_l00894}{894}} of file \mbox{\hyperlink{refineable__elements_8cc_source}{refineable\+\_\+elements.\+cc}}.



References \mbox{\hyperlink{elements_8h_source_l02611}{oomph\+::\+Finite\+Element\+::dim()}}, \mbox{\hyperlink{cfortran_8h_source_l00603}{i}}, \mbox{\hyperlink{elements_8h_source_l03912}{oomph\+::\+Solid\+Finite\+Element\+::lagrangian\+\_\+position\+\_\+gen()}}, \mbox{\hyperlink{elements_8h_source_l01483}{oomph\+::\+Finite\+Element\+::\+N2deriv}}, \mbox{\hyperlink{elements_8h_source_l03785}{oomph\+::\+Solid\+Finite\+Element\+::nnodal\+\_\+lagrangian\+\_\+type()}}, and \mbox{\hyperlink{elements_8h_source_l02210}{oomph\+::\+Finite\+Element\+::nnode()}}.

\mbox{\Hypertarget{classoomph_1_1RefineableSolidElement_a973020f4458c30aa458468b7f757ba7c}\label{classoomph_1_1RefineableSolidElement_a973020f4458c30aa458468b7f757ba7c}} 
\index{oomph::RefineableSolidElement@{oomph::RefineableSolidElement}!assign\_solid\_hanging\_local\_eqn\_numbers@{assign\_solid\_hanging\_local\_eqn\_numbers}}
\index{assign\_solid\_hanging\_local\_eqn\_numbers@{assign\_solid\_hanging\_local\_eqn\_numbers}!oomph::RefineableSolidElement@{oomph::RefineableSolidElement}}
\doxysubsubsection{\texorpdfstring{assign\_solid\_hanging\_local\_eqn\_numbers()}{assign\_solid\_hanging\_local\_eqn\_numbers()}}
{\footnotesize\ttfamily void oomph\+::\+Refineable\+Solid\+Element\+::assign\+\_\+solid\+\_\+hanging\+\_\+local\+\_\+eqn\+\_\+numbers (\begin{DoxyParamCaption}\item[{const bool \&}]{store\+\_\+local\+\_\+dof\+\_\+pt }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Assign local equation numbers to the hanging values associated with positions or additional solid values. 

The standard equation numbering scheme for solid positions, so that hanging \mbox{\hyperlink{classoomph_1_1Node}{Node}} information is included. 

Definition at line \mbox{\hyperlink{refineable__elements_8cc_source_l01178}{1178}} of file \mbox{\hyperlink{refineable__elements_8cc_source}{refineable\+\_\+elements.\+cc}}.



References \mbox{\hyperlink{elements_8cc_source_l00156}{oomph\+::\+Generalised\+Element\+::add\+\_\+global\+\_\+eqn\+\_\+numbers()}}, \mbox{\hyperlink{elements_8h_source_l00231}{oomph\+::\+Generalised\+Element\+::\+Dof\+\_\+pt\+\_\+deque}}, \mbox{\hyperlink{elements_8h_source_l00704}{oomph\+::\+Generalised\+Element\+::eqn\+\_\+number()}}, \mbox{\hyperlink{nodes_8h_source_l01228}{oomph\+::\+Node\+::hanging\+\_\+pt()}}, \mbox{\hyperlink{nodes_8h_source_l00183}{oomph\+::\+Data\+::\+Is\+\_\+pinned}}, \mbox{\hyperlink{elements_8h_source_l00726}{oomph\+::\+Generalised\+Element\+::local\+\_\+eqn\+\_\+number()}}, \mbox{\hyperlink{refineable__elements_8h_source_l00880}{Local\+\_\+position\+\_\+hang\+\_\+eqn}}, \mbox{\hyperlink{nodes_8h_source_l00791}{oomph\+::\+Hang\+Info\+::master\+\_\+node\+\_\+pt()}}, \mbox{\hyperlink{elements_8h_source_l00835}{oomph\+::\+Generalised\+Element\+::ndof()}}, \mbox{\hyperlink{nodes_8h_source_l00785}{oomph\+::\+Hang\+Info\+::nmaster()}}, \mbox{\hyperlink{elements_8h_source_l02463}{oomph\+::\+Finite\+Element\+::nnodal\+\_\+position\+\_\+type()}}, \mbox{\hyperlink{elements_8h_source_l02210}{oomph\+::\+Finite\+Element\+::nnode()}}, \mbox{\hyperlink{elements_8h_source_l02484}{oomph\+::\+Finite\+Element\+::nodal\+\_\+dimension()}}, \mbox{\hyperlink{elements_8h_source_l02175}{oomph\+::\+Finite\+Element\+::node\+\_\+pt()}}, \mbox{\hyperlink{elements_8h_source_l04137}{oomph\+::\+Solid\+Finite\+Element\+::position\+\_\+local\+\_\+eqn()}}, and \mbox{\hyperlink{nodes_8h_source_l01126}{oomph\+::\+Node\+::x\+\_\+gen()}}.



Referenced by \mbox{\hyperlink{refineable__elements_8h_source_l00940}{assign\+\_\+solid\+\_\+local\+\_\+eqn\+\_\+numbers()}}.

\mbox{\Hypertarget{classoomph_1_1RefineableSolidElement_a7718105cbc38cff969a246b093b6ecee}\label{classoomph_1_1RefineableSolidElement_a7718105cbc38cff969a246b093b6ecee}} 
\index{oomph::RefineableSolidElement@{oomph::RefineableSolidElement}!assign\_solid\_local\_eqn\_numbers@{assign\_solid\_local\_eqn\_numbers}}
\index{assign\_solid\_local\_eqn\_numbers@{assign\_solid\_local\_eqn\_numbers}!oomph::RefineableSolidElement@{oomph::RefineableSolidElement}}
\doxysubsubsection{\texorpdfstring{assign\_solid\_local\_eqn\_numbers()}{assign\_solid\_local\_eqn\_numbers()}}
{\footnotesize\ttfamily void oomph\+::\+Refineable\+Solid\+Element\+::assign\+\_\+solid\+\_\+local\+\_\+eqn\+\_\+numbers (\begin{DoxyParamCaption}\item[{const bool \&}]{store\+\_\+local\+\_\+dof\+\_\+pt }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [virtual]}}



Overload the local equation numbers for \mbox{\hyperlink{classoomph_1_1Data}{Data}} stored as part of solid nodes to include hanging node data. 



Reimplemented from \mbox{\hyperlink{classoomph_1_1SolidFiniteElement_a3c7ad30f234e87649ed34cea94f65ea3}{oomph\+::\+Solid\+Finite\+Element}}.



Definition at line \mbox{\hyperlink{refineable__elements_8h_source_l00940}{940}} of file \mbox{\hyperlink{refineable__elements_8h_source}{refineable\+\_\+elements.\+h}}.



References \mbox{\hyperlink{refineable__elements_8cc_source_l01178}{assign\+\_\+solid\+\_\+hanging\+\_\+local\+\_\+eqn\+\_\+numbers()}}, and \mbox{\hyperlink{elements_8cc_source_l06898}{oomph\+::\+Solid\+Finite\+Element\+::assign\+\_\+solid\+\_\+local\+\_\+eqn\+\_\+numbers()}}.

\mbox{\Hypertarget{classoomph_1_1RefineableSolidElement_a1d85edf9f84720ac0de66427d75a5871}\label{classoomph_1_1RefineableSolidElement_a1d85edf9f84720ac0de66427d75a5871}} 
\index{oomph::RefineableSolidElement@{oomph::RefineableSolidElement}!disable\_use\_of\_undeformed\_macro\_element\_for\_new\_lagrangian\_coords@{disable\_use\_of\_undeformed\_macro\_element\_for\_new\_lagrangian\_coords}}
\index{disable\_use\_of\_undeformed\_macro\_element\_for\_new\_lagrangian\_coords@{disable\_use\_of\_undeformed\_macro\_element\_for\_new\_lagrangian\_coords}!oomph::RefineableSolidElement@{oomph::RefineableSolidElement}}
\doxysubsubsection{\texorpdfstring{disable\_use\_of\_undeformed\_macro\_element\_for\_new\_lagrangian\_coords()}{disable\_use\_of\_undeformed\_macro\_element\_for\_new\_lagrangian\_coords()}}
{\footnotesize\ttfamily void oomph\+::\+Refineable\+Solid\+Element\+::disable\+\_\+use\+\_\+of\+\_\+undeformed\+\_\+macro\+\_\+element\+\_\+for\+\_\+new\+\_\+lagrangian\+\_\+coords (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Unset the flag deciding if the Lagrangian coordinates of newly-\/created interior Solid\+Nodes are to be determined by the father element\textquotesingle{}s undeformed \mbox{\hyperlink{classoomph_1_1MacroElement}{Macro\+Element}} representation (if it has one). 



Definition at line \mbox{\hyperlink{refineable__elements_8h_source_l00996}{996}} of file \mbox{\hyperlink{refineable__elements_8h_source}{refineable\+\_\+elements.\+h}}.



References \mbox{\hyperlink{refineable__elements_8h_source_l00899}{Use\+\_\+undeformed\+\_\+macro\+\_\+element\+\_\+for\+\_\+new\+\_\+lagrangian\+\_\+coords}}.

\mbox{\Hypertarget{classoomph_1_1RefineableSolidElement_a65b054a8a113f03e2a11647faa104b6f}\label{classoomph_1_1RefineableSolidElement_a65b054a8a113f03e2a11647faa104b6f}} 
\index{oomph::RefineableSolidElement@{oomph::RefineableSolidElement}!enable\_use\_of\_undeformed\_macro\_element\_for\_new\_lagrangian\_coords@{enable\_use\_of\_undeformed\_macro\_element\_for\_new\_lagrangian\_coords}}
\index{enable\_use\_of\_undeformed\_macro\_element\_for\_new\_lagrangian\_coords@{enable\_use\_of\_undeformed\_macro\_element\_for\_new\_lagrangian\_coords}!oomph::RefineableSolidElement@{oomph::RefineableSolidElement}}
\doxysubsubsection{\texorpdfstring{enable\_use\_of\_undeformed\_macro\_element\_for\_new\_lagrangian\_coords()}{enable\_use\_of\_undeformed\_macro\_element\_for\_new\_lagrangian\_coords()}}
{\footnotesize\ttfamily void oomph\+::\+Refineable\+Solid\+Element\+::enable\+\_\+use\+\_\+of\+\_\+undeformed\+\_\+macro\+\_\+element\+\_\+for\+\_\+new\+\_\+lagrangian\+\_\+coords (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Set the flag deciding if the Lagrangian coordinates of newly-\/created interior Solid\+Nodes are to be determined by the father element\textquotesingle{}s undeformed \mbox{\hyperlink{classoomph_1_1MacroElement}{Macro\+Element}} representation (if it has one). 



Definition at line \mbox{\hyperlink{refineable__elements_8h_source_l00988}{988}} of file \mbox{\hyperlink{refineable__elements_8h_source}{refineable\+\_\+elements.\+h}}.



References \mbox{\hyperlink{refineable__elements_8h_source_l00899}{Use\+\_\+undeformed\+\_\+macro\+\_\+element\+\_\+for\+\_\+new\+\_\+lagrangian\+\_\+coords}}.

\mbox{\Hypertarget{classoomph_1_1RefineableSolidElement_a97f911c422af3e4fbd078b58cfe3e207}\label{classoomph_1_1RefineableSolidElement_a97f911c422af3e4fbd078b58cfe3e207}} 
\index{oomph::RefineableSolidElement@{oomph::RefineableSolidElement}!fill\_in\_jacobian\_from\_solid\_position\_by\_fd@{fill\_in\_jacobian\_from\_solid\_position\_by\_fd}}
\index{fill\_in\_jacobian\_from\_solid\_position\_by\_fd@{fill\_in\_jacobian\_from\_solid\_position\_by\_fd}!oomph::RefineableSolidElement@{oomph::RefineableSolidElement}}
\doxysubsubsection{\texorpdfstring{fill\_in\_jacobian\_from\_solid\_position\_by\_fd()}{fill\_in\_jacobian\_from\_solid\_position\_by\_fd()}}
{\footnotesize\ttfamily void oomph\+::\+Refineable\+Solid\+Element\+::fill\+\_\+in\+\_\+jacobian\+\_\+from\+\_\+solid\+\_\+position\+\_\+by\+\_\+fd (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classoomph_1_1Vector}{Vector}}$<$ double $>$ \&}]{residuals,  }\item[{\mbox{\hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}}$<$ double $>$ \&}]{jacobian }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}



Compute element residual \mbox{\hyperlink{classoomph_1_1Vector}{Vector}} and element Jacobian matrix corresponding to the solid positions. Overloaded version to take the hanging nodes into account. 

This function calculates the entries of Jacobian matrix, used in the Newton method, associated with the elastic problem in which the nodal position is a variable. It does this using finite differences, rather than an analytical formulation, so can be done in total generality. Overload the standard case to include hanging node case. 

Reimplemented from \mbox{\hyperlink{classoomph_1_1SolidFiniteElement_aa4d7dab326ceb0167da34ad4c535fa0d}{oomph\+::\+Solid\+Finite\+Element}}.



Definition at line \mbox{\hyperlink{refineable__elements_8cc_source_l01335}{1335}} of file \mbox{\hyperlink{refineable__elements_8cc_source}{refineable\+\_\+elements.\+cc}}.



References \mbox{\hyperlink{elements_8h_source_l01198}{oomph\+::\+Generalised\+Element\+::\+Default\+\_\+fd\+\_\+jacobian\+\_\+step}}, \mbox{\hyperlink{elements_8h_source_l00980}{oomph\+::\+Generalised\+Element\+::get\+\_\+residuals()}}, \mbox{\hyperlink{nodes_8h_source_l01228}{oomph\+::\+Node\+::hanging\+\_\+pt()}}, \mbox{\hyperlink{cfortran_8h_source_l00603}{i}}, \mbox{\hyperlink{nodes_8h_source_l01285}{oomph\+::\+Node\+::is\+\_\+hanging()}}, \mbox{\hyperlink{refineable__elements_8h_source_l00880}{Local\+\_\+position\+\_\+hang\+\_\+eqn}}, \mbox{\hyperlink{nodes_8h_source_l00791}{oomph\+::\+Hang\+Info\+::master\+\_\+node\+\_\+pt()}}, \mbox{\hyperlink{elements_8h_source_l00835}{oomph\+::\+Generalised\+Element\+::ndof()}}, \mbox{\hyperlink{nodes_8h_source_l00785}{oomph\+::\+Hang\+Info\+::nmaster()}}, \mbox{\hyperlink{elements_8h_source_l02463}{oomph\+::\+Finite\+Element\+::nnodal\+\_\+position\+\_\+type()}}, \mbox{\hyperlink{elements_8h_source_l02210}{oomph\+::\+Finite\+Element\+::nnode()}}, \mbox{\hyperlink{elements_8h_source_l02484}{oomph\+::\+Finite\+Element\+::nodal\+\_\+dimension()}}, \mbox{\hyperlink{elements_8h_source_l02175}{oomph\+::\+Finite\+Element\+::node\+\_\+pt()}}, \mbox{\hyperlink{nodes_8h_source_l01615}{oomph\+::\+Node\+::perform\+\_\+auxiliary\+\_\+node\+\_\+update\+\_\+fct()}}, \mbox{\hyperlink{elements_8h_source_l04137}{oomph\+::\+Solid\+Finite\+Element\+::position\+\_\+local\+\_\+eqn()}}, \mbox{\hyperlink{elements_8h_source_l04245}{oomph\+::\+Solid\+Finite\+Element\+::reset\+\_\+after\+\_\+solid\+\_\+position\+\_\+fd()}}, \mbox{\hyperlink{elements_8h_source_l04255}{oomph\+::\+Solid\+Finite\+Element\+::reset\+\_\+in\+\_\+solid\+\_\+position\+\_\+fd()}}, \mbox{\hyperlink{elements_8h_source_l04240}{oomph\+::\+Solid\+Finite\+Element\+::update\+\_\+before\+\_\+solid\+\_\+position\+\_\+fd()}}, \mbox{\hyperlink{elements_8h_source_l04250}{oomph\+::\+Solid\+Finite\+Element\+::update\+\_\+in\+\_\+solid\+\_\+position\+\_\+fd()}}, and \mbox{\hyperlink{nodes_8h_source_l01126}{oomph\+::\+Node\+::x\+\_\+gen()}}.

\mbox{\Hypertarget{classoomph_1_1RefineableSolidElement_a159967ccbb5327b2ee04154a11b1b51c}\label{classoomph_1_1RefineableSolidElement_a159967ccbb5327b2ee04154a11b1b51c}} 
\index{oomph::RefineableSolidElement@{oomph::RefineableSolidElement}!further\_build@{further\_build}}
\index{further\_build@{further\_build}!oomph::RefineableSolidElement@{oomph::RefineableSolidElement}}
\doxysubsubsection{\texorpdfstring{further\_build()}{further\_build()}}
{\footnotesize\ttfamily virtual void oomph\+::\+Refineable\+Solid\+Element\+::further\+\_\+build (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [virtual]}}



Further build\+: Pass the father\textquotesingle{}s Use\+\_\+undeformed\+\_\+macro\+\_\+element\+\_\+for\+\_\+new\+\_\+lagrangian\+\_\+coords flag down, then call the underlying \mbox{\hyperlink{classoomph_1_1RefineableElement}{Refineable\+Element}}\textquotesingle{}s version. 



Reimplemented from \mbox{\hyperlink{classoomph_1_1RefineableElement_a26628ce36dfad028686adeb4694a9ef3}{oomph\+::\+Refineable\+Element}}.



Reimplemented in \mbox{\hyperlink{classoomph_1_1RefineablePVDEquations_a936bab952ddbad5093cb7ee80d0019b5}{oomph\+::\+Refineable\+PVDEquations$<$ DIM $>$}}, \mbox{\hyperlink{classoomph_1_1RefineablePVDEquationsWithPressure_aad92965f2aec749e75580d003eebdc91}{oomph\+::\+Refineable\+PVDEquations\+With\+Pressure$<$ DIM $>$}}, \mbox{\hyperlink{classoomph_1_1RefineableQPVDElementWithPressure_af2981a672382c6db25389aa7c82a6b30}{oomph\+::\+Refineable\+QPVDElement\+With\+Pressure$<$ DIM $>$}}, \mbox{\hyperlink{classoomph_1_1RefineableQPVDElementWithPressure_ad28f98fcd015c895d595fab6ab11e86d}{oomph\+::\+Refineable\+QPVDElement\+With\+Pressure$<$ DIM $>$}}, and \mbox{\hyperlink{classoomph_1_1RefineableQPVDElementWithPressure_a9289f1f2ddbc697e8919a9747fa93e0c}{oomph\+::\+Refineable\+QPVDElement\+With\+Pressure$<$ DIM $>$}}.



Definition at line \mbox{\hyperlink{refineable__elements_8h_source_l01014}{1014}} of file \mbox{\hyperlink{refineable__elements_8h_source}{refineable\+\_\+elements.\+h}}.



References \mbox{\hyperlink{refineable__elements_8h_source_l00539}{oomph\+::\+Refineable\+Element\+::father\+\_\+element\+\_\+pt()}}, \mbox{\hyperlink{refineable__elements_8h_source_l00599}{oomph\+::\+Refineable\+Element\+::further\+\_\+build()}}, \mbox{\hyperlink{refineable__elements_8h_source_l00980}{is\+\_\+undeformed\+\_\+macro\+\_\+element\+\_\+used\+\_\+for\+\_\+new\+\_\+lagrangian\+\_\+coords()}}, and \mbox{\hyperlink{refineable__elements_8h_source_l00899}{Use\+\_\+undeformed\+\_\+macro\+\_\+element\+\_\+for\+\_\+new\+\_\+lagrangian\+\_\+coords}}.



Referenced by \mbox{\hyperlink{refineable__solid__elements_8h_source_l00144}{oomph\+::\+Refineable\+PVDEquations$<$ DIM $>$\+::further\+\_\+build()}}, and \mbox{\hyperlink{refineable__solid__elements_8h_source_l00386}{oomph\+::\+Refineable\+PVDEquations\+With\+Pressure$<$ DIM $>$\+::further\+\_\+build()}}.

\mbox{\Hypertarget{classoomph_1_1RefineableSolidElement_a3f20de56e3a920644b01dac184f67ef1}\label{classoomph_1_1RefineableSolidElement_a3f20de56e3a920644b01dac184f67ef1}} 
\index{oomph::RefineableSolidElement@{oomph::RefineableSolidElement}!geom\_data\_pt@{geom\_data\_pt}}
\index{geom\_data\_pt@{geom\_data\_pt}!oomph::RefineableSolidElement@{oomph::RefineableSolidElement}}
\doxysubsubsection{\texorpdfstring{geom\_data\_pt()}{geom\_data\_pt()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classoomph_1_1Data}{Data}} $\ast$ oomph\+::\+Refineable\+Solid\+Element\+::geom\+\_\+data\+\_\+pt (\begin{DoxyParamCaption}\item[{const unsigned \&}]{j }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}



Return pointer to the j-\/th \mbox{\hyperlink{classoomph_1_1Data}{Data}} item that the object\textquotesingle{}s shape depends on\+: Positional data of non-\/hanging nodes and positional data of master nodes. Recomputed on the fly. 



Reimplemented from \mbox{\hyperlink{classoomph_1_1SolidFiniteElement_a0cb5fd3657899de308ea878948e63a52}{oomph\+::\+Solid\+Finite\+Element}}.



Definition at line \mbox{\hyperlink{refineable__elements_8cc_source_l01055}{1055}} of file \mbox{\hyperlink{refineable__elements_8cc_source}{refineable\+\_\+elements.\+cc}}.



References \mbox{\hyperlink{nodes_8h_source_l01228}{oomph\+::\+Node\+::hanging\+\_\+pt()}}, \mbox{\hyperlink{nodes_8h_source_l00791}{oomph\+::\+Hang\+Info\+::master\+\_\+node\+\_\+pt()}}, \mbox{\hyperlink{nodes_8h_source_l00785}{oomph\+::\+Hang\+Info\+::nmaster()}}, \mbox{\hyperlink{elements_8h_source_l02210}{oomph\+::\+Finite\+Element\+::nnode()}}, and \mbox{\hyperlink{elements_8h_source_l02175}{oomph\+::\+Finite\+Element\+::node\+\_\+pt()}}.

\mbox{\Hypertarget{classoomph_1_1RefineableSolidElement_ac895a84017b3eb57dadc19384b6ce7f4}\label{classoomph_1_1RefineableSolidElement_ac895a84017b3eb57dadc19384b6ce7f4}} 
\index{oomph::RefineableSolidElement@{oomph::RefineableSolidElement}!identify\_geometric\_data@{identify\_geometric\_data}}
\index{identify\_geometric\_data@{identify\_geometric\_data}!oomph::RefineableSolidElement@{oomph::RefineableSolidElement}}
\doxysubsubsection{\texorpdfstring{identify\_geometric\_data()}{identify\_geometric\_data()}}
{\footnotesize\ttfamily void oomph\+::\+Refineable\+Solid\+Element\+::identify\+\_\+geometric\+\_\+data (\begin{DoxyParamCaption}\item[{std\+::set$<$ \mbox{\hyperlink{classoomph_1_1Data}{Data}} $\ast$ $>$ \&}]{geometric\+\_\+data\+\_\+pt }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}



Specify \mbox{\hyperlink{classoomph_1_1Data}{Data}} that affects the geometry of the element by adding the position \mbox{\hyperlink{classoomph_1_1Data}{Data}} to the set that\textquotesingle{}s passed in. (This functionality is required in FSI problems; set is used to avoid double counting). Refineable version includes hanging nodes. 



Reimplemented from \mbox{\hyperlink{classoomph_1_1SolidFiniteElement_a958d2efd4dbbdf4cbd7d882bc56c68c3}{oomph\+::\+Solid\+Finite\+Element}}.



Definition at line \mbox{\hyperlink{refineable__elements_8cc_source_l01137}{1137}} of file \mbox{\hyperlink{refineable__elements_8cc_source}{refineable\+\_\+elements.\+cc}}.



References \mbox{\hyperlink{nodes_8h_source_l01228}{oomph\+::\+Node\+::hanging\+\_\+pt()}}, \mbox{\hyperlink{nodes_8h_source_l00791}{oomph\+::\+Hang\+Info\+::master\+\_\+node\+\_\+pt()}}, \mbox{\hyperlink{nodes_8h_source_l00785}{oomph\+::\+Hang\+Info\+::nmaster()}}, \mbox{\hyperlink{elements_8h_source_l02210}{oomph\+::\+Finite\+Element\+::nnode()}}, and \mbox{\hyperlink{elements_8h_source_l02175}{oomph\+::\+Finite\+Element\+::node\+\_\+pt()}}.

\mbox{\Hypertarget{classoomph_1_1RefineableSolidElement_a23a8382cc9da7809752851db65e20241}\label{classoomph_1_1RefineableSolidElement_a23a8382cc9da7809752851db65e20241}} 
\index{oomph::RefineableSolidElement@{oomph::RefineableSolidElement}!is\_undeformed\_macro\_element\_used\_for\_new\_lagrangian\_coords@{is\_undeformed\_macro\_element\_used\_for\_new\_lagrangian\_coords}}
\index{is\_undeformed\_macro\_element\_used\_for\_new\_lagrangian\_coords@{is\_undeformed\_macro\_element\_used\_for\_new\_lagrangian\_coords}!oomph::RefineableSolidElement@{oomph::RefineableSolidElement}}
\doxysubsubsection{\texorpdfstring{is\_undeformed\_macro\_element\_used\_for\_new\_lagrangian\_coords()}{is\_undeformed\_macro\_element\_used\_for\_new\_lagrangian\_coords()}}
{\footnotesize\ttfamily bool oomph\+::\+Refineable\+Solid\+Element\+::is\+\_\+undeformed\+\_\+macro\+\_\+element\+\_\+used\+\_\+for\+\_\+new\+\_\+lagrangian\+\_\+coords (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Return the flag deciding if the Lagrangian coordinates of newly-\/created interior Solid\+Nodes are to be determined by the father element\textquotesingle{}s undeformed \mbox{\hyperlink{classoomph_1_1MacroElement}{Macro\+Element}} representation (if it has one). Default\+: False as it means that, following a refinement an element is no longer in equilbrium (as the Lagrangian coordinate is determined differently from the Eulerian one). However, basing the Lagrangian coordinates on the undeformed \mbox{\hyperlink{classoomph_1_1MacroElement}{Macro\+Element}} can be more stable numerically and for steady problems it\textquotesingle{}s not a big deal either way as the difference between the two formulations only matters at finite resolution so we have no right to say that one is \char`\"{}more correct\char`\"{} than the other... 



Definition at line \mbox{\hyperlink{refineable__elements_8h_source_l00980}{980}} of file \mbox{\hyperlink{refineable__elements_8h_source}{refineable\+\_\+elements.\+h}}.



References \mbox{\hyperlink{refineable__elements_8h_source_l00899}{Use\+\_\+undeformed\+\_\+macro\+\_\+element\+\_\+for\+\_\+new\+\_\+lagrangian\+\_\+coords}}.



Referenced by \mbox{\hyperlink{refineable__elements_8h_source_l01014}{further\+\_\+build()}}.

\mbox{\Hypertarget{classoomph_1_1RefineableSolidElement_a547e50bc2c13c6e4852c543cd7d38f74}\label{classoomph_1_1RefineableSolidElement_a547e50bc2c13c6e4852c543cd7d38f74}} 
\index{oomph::RefineableSolidElement@{oomph::RefineableSolidElement}!local\_position\_hang\_eqn@{local\_position\_hang\_eqn}}
\index{local\_position\_hang\_eqn@{local\_position\_hang\_eqn}!oomph::RefineableSolidElement@{oomph::RefineableSolidElement}}
\doxysubsubsection{\texorpdfstring{local\_position\_hang\_eqn()}{local\_position\_hang\_eqn()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}}$<$ int $>$ \& oomph\+::\+Refineable\+Solid\+Element\+::local\+\_\+position\+\_\+hang\+\_\+eqn (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classoomph_1_1Node}{Node}} $\ast$const \&}]{node\+\_\+pt }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Access the local equation number of of hanging node variables associated with nodal positions. The function returns a dense matrix that contains all the local equation numbers corresponding to the positional degrees of freedom. 



Definition at line \mbox{\hyperlink{refineable__elements_8h_source_l01005}{1005}} of file \mbox{\hyperlink{refineable__elements_8h_source}{refineable\+\_\+elements.\+h}}.



References \mbox{\hyperlink{refineable__elements_8h_source_l00880}{Local\+\_\+position\+\_\+hang\+\_\+eqn}}, and \mbox{\hyperlink{elements_8h_source_l02175}{oomph\+::\+Finite\+Element\+::node\+\_\+pt()}}.



Referenced by \mbox{\hyperlink{solid__traction__elements_8h_source_l02063}{oomph\+::\+Refineable\+Impose\+Displacement\+By\+Lagrange\+Multiplier\+Element$<$ ELEMENT $>$\+::refineable\+\_\+fill\+\_\+in\+\_\+generic\+\_\+contribution\+\_\+to\+\_\+residuals\+\_\+displ\+\_\+lagr\+\_\+multiplier()}}, and \mbox{\hyperlink{solid__traction__elements_8h_source_l03133}{oomph\+::\+Refineable\+FSIImpose\+Displacement\+By\+Lagrange\+Multiplier\+Element$<$ ELEMENT $>$\+::refineable\+\_\+fill\+\_\+in\+\_\+generic\+\_\+contribution\+\_\+to\+\_\+residuals\+\_\+fsi\+\_\+displ\+\_\+lagr\+\_\+multiplier()}}.

\mbox{\Hypertarget{classoomph_1_1RefineableSolidElement_a492846d9f2c5d5235f9f3ff1001d4ec8}\label{classoomph_1_1RefineableSolidElement_a492846d9f2c5d5235f9f3ff1001d4ec8}} 
\index{oomph::RefineableSolidElement@{oomph::RefineableSolidElement}!local\_to\_lagrangian\_mapping\_diagonal@{local\_to\_lagrangian\_mapping\_diagonal}}
\index{local\_to\_lagrangian\_mapping\_diagonal@{local\_to\_lagrangian\_mapping\_diagonal}!oomph::RefineableSolidElement@{oomph::RefineableSolidElement}}
\doxysubsubsection{\texorpdfstring{local\_to\_lagrangian\_mapping\_diagonal()}{local\_to\_lagrangian\_mapping\_diagonal()}}
{\footnotesize\ttfamily double oomph\+::\+Refineable\+Solid\+Element\+::local\+\_\+to\+\_\+lagrangian\+\_\+mapping\+\_\+diagonal (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{classoomph_1_1DShape}{DShape}} \&}]{dpsids,  }\item[{\mbox{\hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}}$<$ double $>$ \&}]{jacobian,  }\item[{\mbox{\hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}}$<$ double $>$ \&}]{inverse\+\_\+jacobian }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}}



Calculate the mapping from local to Lagrangian coordinates given the derivatives of the shape functions w.\+r.\+t the local coorindates. assuming that the coordinates are aligned in the direction of the local coordinates, i.\+e. there are no cross terms and the jacobian is diagonal. This function returns the determinant of the jacobian, the jacobian and the inverse jacobian. 

Calculate the mapping from local to lagrangian coordinates assuming that the coordinates are aligned in the direction of the local coordinates, i.\+e. there are no cross terms and the jacobian is diagonal. The local derivatives are passed as dpsids and the jacobian and inverse jacobian are returned. 

Reimplemented from \mbox{\hyperlink{classoomph_1_1SolidFiniteElement_a811c926ab4ec81ecb374030302ef28ca}{oomph\+::\+Solid\+Finite\+Element}}.



Definition at line \mbox{\hyperlink{refineable__elements_8cc_source_l00938}{938}} of file \mbox{\hyperlink{refineable__elements_8cc_source}{refineable\+\_\+elements.\+cc}}.



References \mbox{\hyperlink{elements_8cc_source_l01750}{oomph\+::\+Finite\+Element\+::check\+\_\+jacobian()}}, \mbox{\hyperlink{elements_8h_source_l02611}{oomph\+::\+Finite\+Element\+::dim()}}, \mbox{\hyperlink{cfortran_8h_source_l00603}{i}}, \mbox{\hyperlink{elements_8h_source_l03912}{oomph\+::\+Solid\+Finite\+Element\+::lagrangian\+\_\+position\+\_\+gen()}}, \mbox{\hyperlink{elements_8h_source_l03785}{oomph\+::\+Solid\+Finite\+Element\+::nnodal\+\_\+lagrangian\+\_\+type()}}, and \mbox{\hyperlink{elements_8h_source_l02210}{oomph\+::\+Finite\+Element\+::nnode()}}.

\mbox{\Hypertarget{classoomph_1_1RefineableSolidElement_a690e24cdbd9308da1b9e705fd0340de8}\label{classoomph_1_1RefineableSolidElement_a690e24cdbd9308da1b9e705fd0340de8}} 
\index{oomph::RefineableSolidElement@{oomph::RefineableSolidElement}!ngeom\_data@{ngeom\_data}}
\index{ngeom\_data@{ngeom\_data}!oomph::RefineableSolidElement@{oomph::RefineableSolidElement}}
\doxysubsubsection{\texorpdfstring{ngeom\_data()}{ngeom\_data()}}
{\footnotesize\ttfamily unsigned oomph\+::\+Refineable\+Solid\+Element\+::ngeom\+\_\+data (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [virtual]}}



The number of geometric data affecting a Refineable\+Solid\+Finite\+Element is the positional \mbox{\hyperlink{classoomph_1_1Data}{Data}} of all non-\/hanging nodes plus the geometric \mbox{\hyperlink{classoomph_1_1Data}{Data}} of all distinct master nodes. Recomputed on the fly. 



Reimplemented from \mbox{\hyperlink{classoomph_1_1SolidFiniteElement_a73f387da7f31f233b79c2526e8cbc896}{oomph\+::\+Solid\+Finite\+Element}}.



Definition at line \mbox{\hyperlink{refineable__elements_8cc_source_l01003}{1003}} of file \mbox{\hyperlink{refineable__elements_8cc_source}{refineable\+\_\+elements.\+cc}}.



References \mbox{\hyperlink{nodes_8h_source_l01228}{oomph\+::\+Node\+::hanging\+\_\+pt()}}, \mbox{\hyperlink{nodes_8h_source_l00791}{oomph\+::\+Hang\+Info\+::master\+\_\+node\+\_\+pt()}}, \mbox{\hyperlink{nodes_8h_source_l00785}{oomph\+::\+Hang\+Info\+::nmaster()}}, \mbox{\hyperlink{elements_8h_source_l02210}{oomph\+::\+Finite\+Element\+::nnode()}}, and \mbox{\hyperlink{elements_8h_source_l02175}{oomph\+::\+Finite\+Element\+::node\+\_\+pt()}}.



\doxysubsection{Member Data Documentation}
\mbox{\Hypertarget{classoomph_1_1RefineableSolidElement_aa361b9441808d7d194494125abd1f6fd}\label{classoomph_1_1RefineableSolidElement_aa361b9441808d7d194494125abd1f6fd}} 
\index{oomph::RefineableSolidElement@{oomph::RefineableSolidElement}!Local\_position\_hang\_eqn@{Local\_position\_hang\_eqn}}
\index{Local\_position\_hang\_eqn@{Local\_position\_hang\_eqn}!oomph::RefineableSolidElement@{oomph::RefineableSolidElement}}
\doxysubsubsection{\texorpdfstring{Local\_position\_hang\_eqn}{Local\_position\_hang\_eqn}}
{\footnotesize\ttfamily std\+::map$<$\mbox{\hyperlink{classoomph_1_1Node}{Node}}$\ast$, \mbox{\hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}}$<$int$>$ $>$ oomph\+::\+Refineable\+Solid\+Element\+::\+Local\+\_\+position\+\_\+hang\+\_\+eqn\hspace{0.3cm}{\ttfamily [private]}}



Storage for local equation numbers of hanging node variables associated with nodal positions. local position equation number = Local\+\_\+position\+\_\+hang\+\_\+eqn(master\+\_\+node\+\_\+pt,ival) 



Definition at line \mbox{\hyperlink{refineable__elements_8h_source_l00880}{880}} of file \mbox{\hyperlink{refineable__elements_8h_source}{refineable\+\_\+elements.\+h}}.



Referenced by \mbox{\hyperlink{refineable__elements_8cc_source_l01178}{assign\+\_\+solid\+\_\+hanging\+\_\+local\+\_\+eqn\+\_\+numbers()}}, \mbox{\hyperlink{refineable__elements_8cc_source_l01335}{fill\+\_\+in\+\_\+jacobian\+\_\+from\+\_\+solid\+\_\+position\+\_\+by\+\_\+fd()}}, and \mbox{\hyperlink{refineable__elements_8h_source_l01005}{local\+\_\+position\+\_\+hang\+\_\+eqn()}}.

\mbox{\Hypertarget{classoomph_1_1RefineableSolidElement_a7a398d47d3eaf9af809821d806b65973}\label{classoomph_1_1RefineableSolidElement_a7a398d47d3eaf9af809821d806b65973}} 
\index{oomph::RefineableSolidElement@{oomph::RefineableSolidElement}!Use\_undeformed\_macro\_element\_for\_new\_lagrangian\_coords@{Use\_undeformed\_macro\_element\_for\_new\_lagrangian\_coords}}
\index{Use\_undeformed\_macro\_element\_for\_new\_lagrangian\_coords@{Use\_undeformed\_macro\_element\_for\_new\_lagrangian\_coords}!oomph::RefineableSolidElement@{oomph::RefineableSolidElement}}
\doxysubsubsection{\texorpdfstring{Use\_undeformed\_macro\_element\_for\_new\_lagrangian\_coords}{Use\_undeformed\_macro\_element\_for\_new\_lagrangian\_coords}}
{\footnotesize\ttfamily bool oomph\+::\+Refineable\+Solid\+Element\+::\+Use\+\_\+undeformed\+\_\+macro\+\_\+element\+\_\+for\+\_\+new\+\_\+lagrangian\+\_\+coords\hspace{0.3cm}{\ttfamily [protected]}}



Flag deciding if the Lagrangian coordinates of newly-\/created interior Solid\+Nodes are to be determined by the father element\textquotesingle{}s undeformed \mbox{\hyperlink{classoomph_1_1MacroElement}{Macro\+Element}} representation (if it has one). Default\+: False as it means that, following a refinement an element is no longer in equilbrium (as the Lagrangian coordinate is determined differently from the Eulerian one). However, basing the Lagrangian coordinates on the undeformed \mbox{\hyperlink{classoomph_1_1MacroElement}{Macro\+Element}} can be more stable numerically and for steady problems it\textquotesingle{}s not a big deal either way as the difference between the two formulations only matters at finite resolution so we have no right to say that one is \char`\"{}more correct\char`\"{} than the other... 



Definition at line \mbox{\hyperlink{refineable__elements_8h_source_l00899}{899}} of file \mbox{\hyperlink{refineable__elements_8h_source}{refineable\+\_\+elements.\+h}}.



Referenced by \mbox{\hyperlink{refineable__elements_8h_source_l00996}{disable\+\_\+use\+\_\+of\+\_\+undeformed\+\_\+macro\+\_\+element\+\_\+for\+\_\+new\+\_\+lagrangian\+\_\+coords()}}, \mbox{\hyperlink{refineable__elements_8h_source_l00988}{enable\+\_\+use\+\_\+of\+\_\+undeformed\+\_\+macro\+\_\+element\+\_\+for\+\_\+new\+\_\+lagrangian\+\_\+coords()}}, \mbox{\hyperlink{refineable__elements_8h_source_l01014}{further\+\_\+build()}}, and \mbox{\hyperlink{refineable__elements_8h_source_l00980}{is\+\_\+undeformed\+\_\+macro\+\_\+element\+\_\+used\+\_\+for\+\_\+new\+\_\+lagrangian\+\_\+coords()}}.



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{refineable__elements_8h}{refineable\+\_\+elements.\+h}}\item 
\mbox{\hyperlink{refineable__elements_8cc}{refineable\+\_\+elements.\+cc}}\end{DoxyCompactItemize}
